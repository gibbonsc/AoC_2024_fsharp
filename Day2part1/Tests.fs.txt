module Tests

open Expecto
open Logic

let booleanTests =
    testList "Boolean counting" [
        test "counts true values" {
            let results = [true; false; false; false; false; true]
            Expect.equal (countTrue results) 2 "Should count 2 trues"
        }
        
        test "empty list returns zero" {
            Expect.equal (countTrue []) 0 "Empty list should be 0"
        }
    ]

let isMonotoneTests =
    testList "isMonotone testing" [
        test "strictly increasing" [
            let values = [2; 3; 5; 6; 7; 8]
            Expect.Equal (isMonotoneValues) true "assert true"
        ]
        test "strictly decreasing" [
            let values = [99; 96; 93; 90]
            Expect.Equal (isMonotone values) true "assert true"
        ]
        test "strictly nondecreasing" [
            let values = [2; 3; 4; 4; 5]
            Expect.Equal (isMonotone values) false "assert false"
        ]
        test "strictly nonincreasing" [
            let values = [87; 84; 81; 78; 75; 72; 69; 69]
            Expect.Equal (isMonotone values) false "assert false"
        ]
        test "increasing then decreasing" [
            let values = [-1; 0; 1; 2; 3; 4; -1]
            Expect.Equal (isMonotone values) false "assert false"
        ]
        test "decreasing then increasing" [
            let values = [-1; -2; -3; -4; -3; -2; 0; 2; 42]
            Expect.Equal (isMonotone values) false "assert false"
        ]
    ]

let pipelineTests =
    testList "Pipeline operations" [
        test "processes and counts" {
            let input = [1; 6; 3; 8; 2; 9]
            let count = input |> processData |> countTrue
            Expect.equal count 3 "Should have 3 values > 5"
        }
    ]

let allTests =
    testList "All tests" [
        booleanTests
        isMonotoneTests
        pipelineTests
    ]